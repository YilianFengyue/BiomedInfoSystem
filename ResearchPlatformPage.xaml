<Page
    x:Class="BiomedSystem.Pages.ResearchPlatformPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:BiomedSystem.Pages"
    xmlns:viewmodels="using:BiomedSystem.ViewModels"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.DataContext>
        <viewmodels:ResearchPlatformViewModel />
    </Page.DataContext>

    <Page.Resources>
        <!-- 卡片样式 -->
        <Style x:Key="ProjectCardStyle" TargetType="Border">
            <Setter Property="Background" Value="{ThemeResource CardBackgroundFillColorDefaultBrush}" />
            <Setter Property="BorderBrush" Value="{ThemeResource CardStrokeColorDefaultBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="16" />
            <Setter Property="Margin" Value="0,0,0,12" />
        </Style>

        <!-- 主要按钮样式 -->
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{ThemeResource AccentButtonBackground}" />
            <Setter Property="Foreground" Value="{ThemeResource AccentButtonForeground}" />
            <Setter Property="BorderBrush" Value="{ThemeResource AccentButtonBorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="Padding" Value="16,8" />
            <Setter Property="FontWeight" Value="SemiBold" />
        </Style>

        <!-- 次要按钮样式 -->
        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{ThemeResource SubtleFillColorSecondaryBrush}" />
            <Setter Property="Foreground" Value="{ThemeResource TextFillColorPrimaryBrush}" />
            <Setter Property="BorderBrush" Value="{ThemeResource ControlStrokeColorDefaultBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="Padding" Value="12,6" />
        </Style>

        <!-- 状态标签样式 -->
        <Style x:Key="StatusBadgeStyle" TargetType="Border">
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Padding" Value="8,4" />
            <Setter Property="HorizontalAlignment" Value="Left" />
        </Style>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- 页面标题 -->
        <StackPanel Grid.Row="0" Padding="24,16,24,0">
            <TextBlock Text="研究平台" Style="{ThemeResource TitleTextBlockStyle}" />
            <TextBlock Text="{x:Bind GetRoleText(), Mode=OneWay}" 
                      Style="{ThemeResource BodyTextBlockStyle}" 
                      Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
        </StackPanel>

        <!-- 主要内容 -->
        <Pivot Grid.Row="1" Margin="16">
            <!-- 项目标签页 -->
            <PivotItem Header="项目">
                <ScrollViewer>
                    <StackPanel Spacing="0">
                        <!-- 学生视图：可申请的项目 -->
                        <ListView ItemsSource="{x:Bind ViewModel.AvailableProjects}" 
                                 Visibility="{x:Bind ViewModel.IsStudent, Converter={StaticResource BoolToVisibilityConverter}}">
                            <ListView.ItemTemplate>
                                <DataTemplate x:DataType="local:ResearchProject">
                                    <Border Style="{StaticResource ProjectCardStyle}">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <!-- 项目标题和状态 -->
                                            <StackPanel Grid.Row="0">
                                                <TextBlock Text="{x:Bind Title}" 
                                                          Style="{ThemeResource SubtitleTextBlockStyle}" 
                                                          TextWrapping="Wrap" />
                                                
                                                <Border Style="{StaticResource StatusBadgeStyle}"
                                                       Background="{ThemeResource SystemFillColorSuccessBrush}"
                                                       Margin="0,4,0,0">
                                                    <TextBlock Text="可申请" 
                                                              Foreground="White" 
                                                              FontSize="12" 
                                                              FontWeight="SemiBold" />
                                                </Border>
                                            </StackPanel>

                                            <!-- 项目描述 -->
                                            <TextBlock Grid.Row="1" 
                                                      Text="{x:Bind Description}" 
                                                      Style="{ThemeResource BodyTextBlockStyle}" 
                                                      Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                      TextWrapping="Wrap" 
                                                      Margin="0,8,0,0" />

                                            <!-- 项目信息 -->
                                            <Grid Grid.Row="2" Margin="0,12,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="指导教师" 
                                                              Style="{ThemeResource CaptionTextBlockStyle}" 
                                                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                                    <TextBlock Text="{x:Bind TeacherName}" 
                                                              Style="{ThemeResource BodyTextBlockStyle}" />
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="经费预算" 
                                                              Style="{ThemeResource CaptionTextBlockStyle}" 
                                                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                                    <TextBlock Text="{x:Bind Funding, StringFormat='¥{0:N0}'}" 
                                                              Style="{ThemeResource BodyTextBlockStyle}" />
                                                </StackPanel>
                                            </Grid>

                                            <!-- 时间信息 -->
                                            <Grid Grid.Row="3" Margin="0,8,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="开始时间" 
                                                              Style="{ThemeResource CaptionTextBlockStyle}" 
                                                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                                    <TextBlock Text="{x:Bind StartDate, StringFormat='{}{0:yyyy-MM-dd}'}" 
                                                              Style="{ThemeResource BodyTextBlockStyle}" />
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="结束时间" 
                                                              Style="{ThemeResource CaptionTextBlockStyle}" 
                                                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                                    <TextBlock Text="{x:Bind EndDate, StringFormat='{}{0:yyyy-MM-dd}'}" 
                                                              Style="{ThemeResource BodyTextBlockStyle}" />
                                                </StackPanel>
                                            </Grid>

                                            <!-- 操作按钮 -->
                                            <StackPanel Grid.Row="4" 
                                                       Orientation="Horizontal" 
                                                       HorizontalAlignment="Right" 
                                                       Spacing="8" 
                                                       Margin="0,16,0,0">
                                                <Button Content="查看详情" 
                                                       Style="{StaticResource SecondaryButtonStyle}"
                                                       Command="{x:Bind DataContext.ViewProjectDetailsCommand, Source={x:Bind }}"
                                                       CommandParameter="{x:Bind}" />
                                                
                                                <Button Content="{x:Bind GetApplicationButtonText()}" 
                                                       Style="{StaticResource PrimaryButtonStyle}"
                                                       IsEnabled="{x:Bind CanApply}"
                                                       Command="{x:Bind DataContext.ApplyForProjectCommand, Source={x:Bind }}"
                                                       CommandParameter="{x:Bind}" />
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>

                        <!-- 教师视图：管理的项目 -->
                        <ListView ItemsSource="{x:Bind ViewModel.TeacherProjects}" 
                                 Visibility="{x:Bind ViewModel.IsTeacher, Converter={StaticResource BoolToVisibilityConverter}}">
                            <ListView.ItemTemplate>
                                <DataTemplate x:DataType="local:ResearchProject">
                                    <Border Style="{StaticResource ProjectCardStyle}">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <!-- 项目标题和状态 -->
                                            <StackPanel Grid.Row="0">
                                                <TextBlock Text="{x:Bind Title}" 
                                                          Style="{ThemeResource SubtitleTextBlockStyle}" 
                                                          TextWrapping="Wrap" />
                                                
                                                <Border Style="{StaticResource StatusBadgeStyle}"
                                                       Background="{x:Bind GetStatusColor()}"
                                                       Margin="0,4,0,0">
                                                    <TextBlock Text="{x:Bind Status}" 
                                                              Foreground="White" 
                                                              FontSize="12" 
                                                              FontWeight="SemiBold" />
                                                </Border>
                                            </StackPanel>

                                            <!-- 项目信息 -->
                                            <Grid Grid.Row="1" Margin="0,12,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="参与学生" 
                                                              Style="{ThemeResource CaptionTextBlockStyle}" 
                                                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                                    <TextBlock Text="{x:Bind StudentCount}" 
                                                              Style="{ThemeResource BodyTextBlockStyle}" />
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="经费预算" 
                                                              Style="{ThemeResource CaptionTextBlockStyle}" 
                                                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                                    <TextBlock Text="{x:Bind Funding, StringFormat='¥{0:N0}'}" 
                                                              Style="{ThemeResource BodyTextBlockStyle}" />
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Column="2">
                                                    <TextBlock Text="创建时间" 
                                                              Style="{ThemeResource CaptionTextBlockStyle}" 
                                                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                                    <TextBlock Text="{x:Bind CreatedDate, StringFormat='{}{0:yyyy-MM-dd}'}" 
                                                              Style="{ThemeResource BodyTextBlockStyle}" />
                                                </StackPanel>
                                            </Grid>

                                            <!-- 项目描述 -->
                                            <TextBlock Grid.Row="2" 
                                                      Text="{x:Bind Description}" 
                                                      Style="{ThemeResource BodyTextBlockStyle}" 
                                                      Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                      TextWrapping="Wrap" 
                                                      Margin="0,8,0,0" />

                                            <!-- 操作按钮 -->
                                            <StackPanel Grid.Row="3" 
                                                       Orientation="Horizontal" 
                                                       HorizontalAlignment="Right" 
                                                       Spacing="8" 
                                                       Margin="0,16,0,0">
                                                <Button Content="编辑项目" 
                                                       Style="{StaticResource SecondaryButtonStyle}"
                                                       Command="{x:Bind DataContext.EditProjectCommand, Source={x:Bind }}"
                                                       CommandParameter="{x:Bind}" />
                                                
                                                <Button Content="管理申请" 
                                                       Style="{StaticResource PrimaryButtonStyle}"
                                                       Command="{x:Bind DataContext.ManageApplicationsCommand, Source={x:Bind }}"
                                                       CommandParameter="{x:Bind}" />
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </ScrollViewer>
            </PivotItem>

            <!-- 论文投稿标签页 -->
            <PivotItem Header="论文投稿">
                <ScrollViewer>
                    <ListView ItemsSource="{x:Bind ViewModel.Submissions}">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="local:ResearchSubmission">
                                <Border Style="{StaticResource ProjectCardStyle}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <!-- 论文标题和状态 -->
                                        <StackPanel Grid.Row="0">
                                            <TextBlock Text="{x:Bind Title}" 
                                                      Style="{ThemeResource SubtitleTextBlockStyle}" 
                                                      TextWrapping="Wrap" />
                                            
                                            <Border Style="{StaticResource StatusBadgeStyle}"
                                                   Background="{x:Bind GetStatusColor()}"
                                                   Margin="0,4,0,0">
                                                <TextBlock Text="{x:Bind Status}" 
                                                          Foreground="White" 
                                                          FontSize="12" 
                                                          FontWeight="SemiBold" />
                                            </Border>
                                        </StackPanel>

                                        <!-- 论文摘要 -->
                                        <TextBlock Grid.Row="1" 
                                                  Text="{x:Bind Abstract}" 
                                                  Style="{ThemeResource BodyTextBlockStyle}" 
                                                  Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                  TextWrapping="Wrap" 
                                                  Margin="0,8,0,0"
                                                  MaxLines="3" />

                                        <!-- 论文信息 -->
                                        <Grid Grid.Row="2" Margin="0,12,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="期刊/会议" 
                                                          Style="{ThemeResource CaptionTextBlockStyle}" 
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                                <TextBlock Text="{x:Bind Journal}" 
                                                          Style="{ThemeResource BodyTextBlockStyle}" />
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="版本" 
                                                          Style="{ThemeResource CaptionTextBlockStyle}" 
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                                <TextBlock Text="{x:Bind Version, StringFormat='v{0}'}" 
                                                          Style="{ThemeResource BodyTextBlockStyle}" />
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="提交时间" 
                                                          Style="{ThemeResource CaptionTextBlockStyle}" 
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                                <TextBlock Text="{x:Bind SubmissionDate, StringFormat='{}{0:yyyy-MM-dd}'}" 
                                                          Style="{ThemeResource BodyTextBlockStyle}" />
                                            </StackPanel>
                                        </Grid>

                                        <!-- 操作按钮 -->
                                        <StackPanel Grid.Row="3" 
                                                   Orientation="Horizontal" 
                                                   HorizontalAlignment="Right" 
                                                   Spacing="8" 
                                                   Margin="0,16,0,0">
                                            <Button Content="下载论文" 
                                                   Style="{StaticResource SecondaryButtonStyle}"
                                                   Command="{x:Bind DataContext.DownloadPaperCommand, Source={x:Bind }}"
                                                   CommandParameter="{x:Bind}" />
                                            
                                            <Button Content="查看详情" 
                                                   Style="{StaticResource PrimaryButtonStyle}"
                                                   Command="{x:Bind DataContext.ViewSubmissionDetailsCommand, Source={x:Bind }}"
                                                   CommandParameter="{x:Bind}" />
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </ScrollViewer>
            </PivotItem>

            <!-- 申请管理标签页 -->
            <PivotItem Header="申请管理" Visibility="{x:Bind ViewModel.IsTeacher, Converter={StaticResource BoolToVisibilityConverter}}">
                <ScrollViewer>
                    <ListView ItemsSource="{x:Bind ViewModel.PendingApplications}">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="local:ResearchApplication">
                                <Border Style="{StaticResource ProjectCardStyle}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <!-- 申请信息标题 -->
                                        <StackPanel Grid.Row="0">
                                            <TextBlock Text="{x:Bind ProjectTitle}" 
                                                      Style="{ThemeResource SubtitleTextBlockStyle}" />
                                            <TextBlock Text="{x:Bind StudentName, StringFormat='申请人：{0}'}" 
                                                      Style="{ThemeResource BodyTextBlockStyle}" 
                                                      Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                            
                                            <Border Style="{StaticResource StatusBadgeStyle}"
                                                   Background="{ThemeResource SystemFillColorCautionBrush}"
                                                   Margin="0,4,0,0">
                                                <TextBlock Text="待审核" 
                                                          Foreground="White" 
                                                          FontSize="12" 
                                                          FontWeight="SemiBold" />
                                            </Border>
                                        </StackPanel>

                                        <!-- 申请说明 -->
                                        <TextBlock Grid.Row="1" 
                                                  Text="{x:Bind ApplicationReason}" 
                                                  Style="{ThemeResource BodyTextBlockStyle}" 
                                                  Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                  TextWrapping="Wrap" 
                                                  Margin="0,8,0,0" />

                                        <!-- 操作按钮 -->
                                        <StackPanel Grid.Row="2" 
                                                   Orientation="Horizontal" 
                                                   HorizontalAlignment="Right" 
                                                   Spacing="8" 
                                                   Margin="0,16,0,0">
                                            <Button Content="拒绝" 
                                                   Style="{StaticResource SecondaryButtonStyle}"
                                                   Command="{x:Bind DataContext.RejectApplicationCommand, Source={x:Bind }}"
                                                   CommandParameter="{x:Bind}" />
                                            
                                            <Button Content="批准" 
                                                   Style="{StaticResource PrimaryButtonStyle}"
                                                   Command="{x:Bind DataContext.ApproveApplicationCommand, Source={x:Bind }}"
                                                   CommandParameter="{x:Bind}" />
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </ScrollViewer>
            </PivotItem>

            <!-- 任务管理标签页 -->
            <PivotItem Header="任务管理">
                <ScrollViewer>
                    <ListView ItemsSource="{x:Bind ViewModel.Tasks}">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="local:ResearchTask">
                                <Border Style="{StaticResource ProjectCardStyle}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <!-- 任务标题和优先级 -->
                                        <StackPanel Grid.Row="0">
                                            <TextBlock Text="{x:Bind Title}" 
                                                      Style="{ThemeResource SubtitleTextBlockStyle}" 
                                                      TextWrapping="Wrap" />
                                            
                                            <Border Style="{StaticResource StatusBadgeStyle}"
                                                   Background="{x:Bind GetPriorityColor()}"
                                                   Margin="0,4,0,0">
                                                <TextBlock Text="{x:Bind Priority}" 
                                                          Foreground="White" 
                                                          FontSize="12" 
                                                          FontWeight="SemiBold" />
                                            </Border>
                                        </StackPanel>

                                        <!-- 任务描述 -->
                                        <TextBlock Grid.Row="1" 
                                                  Text="{x:Bind Description}" 
                                                  Style="{ThemeResource BodyTextBlockStyle}" 
                                                  Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                  TextWrapping="Wrap" 
                                                  Margin="0,8,0,0" />

                                        <!-- 进度条和截止时间 -->
                                        <Grid Grid.Row="2" Margin="0,12,0,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            
                                            <Grid Grid.Row="0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                
                                                <TextBlock Grid.Column="0" 
                                                          Text="进度" 
                                                          Style="{ThemeResource CaptionTextBlockStyle}" 
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                          VerticalAlignment="Center" />
                                                
                                                <ProgressBar Grid.Column="1" 
                                                            Value="{x:Bind Progress}" 
                                                            Maximum="100"
                                                            Margin="8,0" />
                                                
                                                <TextBlock Grid.Column="2" 
                                                          Text="{x:Bind Progress, StringFormat='{0:F0}%'}" 
                                                          Style="{ThemeResource CaptionTextBlockStyle}" 
                                                          VerticalAlignment="Center" />
                                            </Grid>
                                            
                                            <TextBlock Grid.Row="1" 
                                                      Text="{x:Bind Deadline, StringFormat='截止时间：{0:yyyy-MM-dd}'}" 
                                                      Style="{ThemeResource CaptionTextBlockStyle}" 
                                                      Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                      Margin="0,4,0,0" />
                                        </Grid>

                                        <!-- 操作按钮 -->
                                        <StackPanel Grid.Row="3" 
                                                   Orientation="Horizontal" 
                                                   HorizontalAlignment="Right" 
                                                   Spacing="8" 
                                                   Margin="0,16,0,0">
                                            <Button Content="更新进度" 
                                                   Style="{StaticResource SecondaryButtonStyle}"
                                                   Command="{x:Bind DataContext.UpdateTaskProgressCommand, Source={x:Bind }}"
                                                   CommandParameter="{x:Bind}" />
                                            
                                            <Button Content="查看详情" 
                                                   Style="{StaticResource PrimaryButtonStyle}"
                                                   Command="{x:Bind DataContext.ViewTaskDetailsCommand, Source={x:Bind }}"
                                                   CommandParameter="{x:Bind}" />
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </ScrollViewer>
            </PivotItem>
        </Pivot>
    </Grid>
</Page> 